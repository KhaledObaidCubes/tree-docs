(function(i,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("hash-sum"),require("vue-inbrowser-compiler-sucrase"),require("@vue/compiler-dom"),require("@vue/compiler-core"),require("acorn"),require("acorn-walk"),require("vue-prism-editor"),require("vue-inbrowser-prismjs-highlighter"),require("debounce")):typeof define=="function"&&define.amd?define(["exports","vue","hash-sum","vue-inbrowser-compiler-sucrase","@vue/compiler-dom","@vue/compiler-core","acorn","acorn-walk","vue-prism-editor","vue-inbrowser-prismjs-highlighter","debounce"],t):(i=typeof globalThis<"u"?globalThis:i||self,t(i.VueLive={},i.Vue,i.Hash,i.VueInBrowserCompilerSucrase,i.VueCompilerDom,i.VueCompilerCore,i.Acorn,i.AcornWalk,i.VuePrismEditor,i.VueInBrowserPrismjsHighlighter,i.Debounce))})(this,function(i,t,f,v,F,R,k,O,V,q,I){"use strict";var ue=Object.defineProperty;var me=(i,t,f)=>t in i?ue(i,t,{enumerable:!0,configurable:!0,writable:!0,value:f}):i[t]=f;var E=(i,t,f)=>(me(i,typeof t!="symbol"?t+"":t,f),f);function M(e){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const o in e)if(o!=="default"){const n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(r,o,n.get?n:{enumerable:!0,get:()=>e[o]})}}return r.default=e,Object.freeze(r)}const x=M(t),U=1,G=4,z=5;function B(e,r){if(!e.template)return;let o;try{o=F.parse(e.template)}catch(d){throw R.createCompilerError(d.code,d.loc)}if(!r)return;const n=e.props?Array.isArray(e.props)?e.props:Object.keys(e.props):[],s=e.data?typeof e.data=="function"?Object.keys(e.data()):Object.keys(e.data):[],l=e.computed?Object.keys(e.computed):[],a=e&&e.methods?Object.keys(e.methods):[],c=e&&typeof e.setup=="function"?Object.keys(e.setup()??{}):[],p=[...n,...s,...l,...a,...c];D(o,[(d,T)=>{const m=[];if(d.type===U)d.props.forEach(u=>{const g=u.type!==G&&u.exp?u.exp.content:void 0;if(g)if(u.name==="slot"){const h=k.parse(`var ${g}=1`,{ecmaVersion:2020});O.simple(h,{VariableDeclarator(P){const{id:y}=P;switch(y.type){case"ArrayPattern":y.elements.forEach(b=>{m.push(b.name)});break;case"ObjectPattern":y.properties.forEach(b=>{m.push(b.value.name)});break;case"Identifier":m.push(y.name);break}return!1}})}else if(u.name==="for"){const[h]=g.split(/( in | of )/),P=/\((\w+),(\w+)\)/;if(P.test(h.replace(" ",""))){const[,y,b]=Array.from(P.exec(h.replace(" ",""))||[]);m.push(y||""),m.push(b||"")}else m.push(h)}else try{$(g,p,[...T,...m])}catch(h){throw new S(h.message,g,h,u.loc)}});else if(d.type===z)try{d.content&&$(d.content.content,p,T)}catch(u){throw new S(u.message,d.content,u,d.loc)}return m}])}function $(e,r,o){const n=k.parse(`(function(){return ${e}})()`,{ecmaVersion:2020});O.ancestor(n,{Identifier(s,l){const a=s.name;if(!(l.length>=2&&l[l.length-2].type==="CallExpression"&&l[l.length-2].callee.name===a)&&r.indexOf(a)===-1&&o.indexOf(a)===-1&&!/^\$/.test(a)){if(l.filter(p=>p.type==="ArrowFunctionExpression"||p.type==="FunctionExpression").some(p=>p.params.some(d=>d.name===a)))return;throw new K(`Variable "${a}" is not defined.`,a)}}})}function D(e,r,o=[]){const n=(l,a)=>{const{children:c}=l;if(c)for(const p of c)D(p,r,a)},s=r.reduce((l,a)=>{const c=a(e,o);return c&&c.length?l.concat(c):l},[]);n(e,[...o,...s])}class K extends Error{constructor(o,n){super(o);E(this,"varName");this.varName=n}}class S extends Error{constructor(o,n,s,l){super(o);E(this,"expression");E(this,"subError");E(this,"loc");this.expression=n,this.subError=s,this.loc=l}}function Y(e,r,o,n,s){return new Function("require","__pragma__","__concatenate__","h",e)(r,o,n,s)}function H(e,r){if(e=e||{},!(r in e))throw new Error("import or require() statements can be added only by setting it using the requires prop");return e[r]}const J=t.defineComponent({name:"VueLivePreviewComponent",emits:["error","success","detect-language"],components:{},errorCaptured(e){this.handleError(e)},props:{debug:{type:Boolean,default:!1},code:{type:String,required:!0},components:{type:Object,default:()=>{}},directives:{type:Object,default:()=>{}},requires:{type:Object,default:()=>{}},jsx:{type:Boolean,default:!1},dataScope:{type:Object,default:()=>{}},checkVariableAvailability:{type:Boolean,default:!0}},data(){return{scope:this.generateScope(),previewedComponent:t.markRaw(t.defineComponent({render:()=>t.h("div")})),iteration:0,error:!1,removeScopedStyle:()=>{},compiledCodeForDebug:""}},computed:{requiresPlusVue(){return{vue:x,...this.requires}}},created(){this.renderComponent(this.code.trim())},destroyed(){this.removeStyle()},watch:{code(e){this.renderComponent(e.trim())}},methods:{generateScope(){return"v-xxxxxxxx".replace(/[xy]/g,e=>{const r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)})},handleError(e){e.constructor===S&&(e.message=`Cannot parse template expression: ${JSON.stringify(e.expression.content||e.expression)}

${e.message}`),this.$emit("error",e),this.error=e.message},removeStyle(){this.removeScopedStyle&&this.removeScopedStyle()},async renderComponent(e){let r=t.defineComponent({}),o;const n=`data-${this.scope}`;try{const s=v.compile(e,this.jsx?{jsxPragma:"__pragma__(h)"}:{},n);if(this.debug&&(this.compiledCodeForDebug=Object.entries(s).map(([a,c])=>typeof c=="string"?`<${a}>
${c}
</${a}>`:"").join(`

`)),o=s.style,s.script){this.$emit("detect-language",v.isCodeVueSfc(e)?"vue":"vsg");const a=async()=>{const c=s.script,p={};await Promise.allSettled(Object.keys(this.requiresPlusVue).map(async d=>{p[d]=this.requiresPlusVue[d]instanceof Promise?(await this.requiresPlusVue[d]).default:this.requiresPlusVue[d]})),r=t.defineComponent(Y(c,d=>H(p,d),v.adaptCreateElement,v.concatenate,t.h)||{}),r.name="VueLiveCompiledExample"};if(await a(),typeof r.template=="string"&&(s.template=r.template,v.compileTemplateForEval(s),await a(),B({...r,template:r.template},this.checkVariableAvailability),delete r.template),this.dataScope){const c={...r==null?void 0:r.data(),...this.dataScope};r.data=()=>c}}const l=s.raw.template;l&&B({...r,template:l},this.checkVariableAvailability)}catch(s){this.handleError(s);return}if(this.components&&(r.components?r.components={...r.components,...this.components}:r.components=this.components),this.directives&&(r.directives?r.directives={...r.directives,...this.directives}:r.directives=this.directives),this.removeStyle(),o&&(r.__scopeId=n,this.removeScopedStyle=v.addScopedStyle(o,this.scope)),!r.render){this.handleError({message:"[Vue Live] no template or render function specified. Example cannot be rendered."});return}r.errorCaptured=s=>(this.handleError(s),!1),this.previewedComponent=t.markRaw(r),this.iteration=this.iteration+1,this.error=!1,this.$emit("success")}}}),he="",w=(e,r)=>{const o=e.__vccOpts||e;for(const[n,s]of r)o[n]=s;return o},X={key:0},Q={key:1,class:"VueLive-error"};function W(e,r,o,n,s,l){return t.openBlock(),t.createElementBlock(t.Fragment,null,[e.debug?(t.openBlock(),t.createElementBlock("pre",X,t.toDisplayString(e.compiledCodeForDebug),1)):t.createCommentVNode("",!0),e.error?(t.openBlock(),t.createElementBlock("pre",Q,t.toDisplayString(e.error),1)):e.previewedComponent?(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.previewedComponent),{key:e.iteration},t.createSlots({_:2},[t.renderList(e.$slots,(a,c)=>({name:c,fn:t.withCtx(p=>[t.renderSlot(e.$slots,c,t.normalizeProps(t.guardReactiveProps(p)))])}))]),1024)):t.createCommentVNode("",!0)],64)}const _=w(J,[["render",W]]),fe="",Z=300,ee=t.defineComponent({name:"VueLiveEditor",inheritAttrs:!1,components:{PrismEditor:V.PrismEditor},props:{code:{type:String,required:!0},error:{type:[Error,Object],default:void 0},delay:{type:Number,default:Z},editorProps:{type:Object,default:()=>({})},prismLang:{type:String,default:"html",validator:e=>q.CONFIGURED_LANGS.includes(e)},jsx:{type:Boolean,default:!1},squiggles:{type:Boolean,default:!0}},data(){return{updatePreview:()=>{},stableCode:this.code,highlight:()=>e=>e}},async beforeMount(){this.highlight=await q("VueLive-squiggles")},methods:{highlighter(e){return this.highlight(this.prismLang,this.jsx)(e,this.squiggles&&this.adaptedErrorLoc?this.adaptedErrorLoc:void 0)}},computed:{adaptedErrorLoc(){var n;if(this.prismLang!=="vsg")return;const e=/\n[\t ]*</.exec(this.stableCode),r=e?this.stableCode.slice(0,e.index+1):"",o=(/^[\t ]*</.test(r)?0:((n=r.match(/\n/g))==null?void 0:n.length)||0)+1;return this.error&&this.error.loc?this.error.loc.start?{start:{...this.error.loc.start,line:this.error.loc.start.line+o},end:{...this.error.loc.end,line:this.error.loc.end.line+o}}:this.error.loc.line?{start:{...this.error.loc,line:this.error.loc.line+o},end:{...this.error.loc,line:this.error.loc.line+o}}:void 0:void 0}},watch:{code(e){this.updatePreview(e)}},created(){this.updatePreview=I(e=>{this.stableCode=e,this.$emit("change",e)},this.delay)}}),ve="";function te(e,r,o,n,s,l){const a=t.resolveComponent("PrismEditor");return t.openBlock(),t.createBlock(a,t.mergeProps({class:{"VueLive-LineNumbers":e.editorProps.lineNumbers},modelValue:e.stableCode,"onUpdate:modelValue":[r[0]||(r[0]=c=>e.stableCode=c),e.updatePreview],highlight:e.highlighter},e.editorProps,{lineNumbers:!1}),null,16,["class","modelValue","onUpdate:modelValue","highlight"])}const j=w(ee,[["render",te]]),ye="",re={},oe={class:"VueLive-container"},ie={class:"VueLive-editor"},se={class:"VueLivePreview"};function ne(e,r){return t.openBlock(),t.createElementBlock("div",oe,[t.createElementVNode("div",ie,[t.renderSlot(e.$slots,"editor")]),t.createElementVNode("div",se,[t.renderSlot(e.$slots,"preview")])])}const ae=w(re,[["render",ne]]),ce={vue:"html",vsg:"vsg"},le=300,de=t.defineComponent({name:"VueLive",components:{Preview:_,Editor:j},props:{code:{type:String,required:!0},layout:{type:Object,default:void 0},components:{type:Object,default:()=>{}},directives:{type:Object,default:()=>{}},requires:{type:Object,default:()=>{}},delay:{type:Number,default:le},jsx:{type:Boolean,default:!1},layoutProps:{type:Object,default:void 0},editorProps:{type:Object,default:()=>({})},dataScope:{type:Object,default:()=>{}},checkVariableAvailability:{type:Boolean,default:!0},squiggles:{type:Boolean,default:!0}},data(){return{model:this.code,lang:"vue",prismLang:"html",VueLiveDefaultLayout:t.markRaw(ae),stableCode:this.code,error:void 0}},computed:{codeKey(){return f(this.model)}},watch:{code(e){this.stableCode=e,this.model=e}},methods:{updatePreview(e){this.stableCode=e,this.model=e,this.$emit("change",e)},switchLanguage(e){this.lang=e;const r=ce[e];this.prismLang!==r&&(this.prismLang=r,this.stableCode=this.model)},handleSuccess(){this.error=void 0,this.$emit("success")},handleError(e){this.error=e,this.$emit("error",e)}}});function pe(e,r,o,n,s,l){const a=t.resolveComponent("Editor"),c=t.resolveComponent("Preview");return t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.layout?e.layout:e.VueLiveDefaultLayout),t.mergeProps(e.layoutProps,{code:e.stableCode,language:e.lang,"prism-lang":e.prismLang,requires:e.requires,"data-scope":e.dataScope,components:e.components}),{editor:t.withCtx(()=>[t.createVNode(a,{code:e.stableCode,delay:e.delay,"prism-lang":e.prismLang,"editor-props":e.editorProps,error:e.error,jsx:e.jsx,squiggles:e.squiggles,onChange:e.updatePreview},null,8,["code","delay","prism-lang","editor-props","error","jsx","squiggles","onChange"])]),preview:t.withCtx(()=>[(t.openBlock(),t.createBlock(c,{key:e.codeKey,code:e.model,onDetectLanguage:e.switchLanguage,onError:e.handleError,onSuccess:e.handleSuccess,components:e.components,directives:e.directives,requires:e.requires,jsx:e.jsx,"data-scope":e.dataScope,"check-variable-availability":e.checkVariableAvailability},null,8,["code","onDetectLanguage","onError","onSuccess","components","directives","requires","jsx","data-scope","check-variable-availability"]))]),_:1},16,["code","language","prism-lang","requires","data-scope","components"])}const N=w(de,[["render",pe]]);function L(e){L.installed||(L.installed=!0,e.component("VueLive",N),e.component("VueLivePreview",_),e.component("VueLiveEditor",j))}const A={install:L};let C=null;typeof window<"u"?C=window.Vue:typeof global<"u"&&(C=global.Vue),C&&C.use(A),i.VueLive=N,i.VueLiveEditor=j,i.VueLivePreview=_,i.default=A,i.install=L,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
